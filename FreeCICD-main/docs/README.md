# FreeCICD Documentation

## Overview

FreeCICD is a **CI/CD pipeline management tool** built on a customizable Blazor WebAssembly framework. This documentation covers the system architecture, individual project documentation, and development guides.

---

## Quick Links

| Document | Description |
|----------|-------------|
| [Team Roleplay Guide](QUICKSTART_TEAM_ROLEPLAY.md) | Collaborative problem-solving framework |
| [Migration README](../FREECICD_MIGRATION_README.md) | .NET 9 to .NET 10 migration guide |
| [Migration Plan](../FREECICD_MIGRATION_PLAN.md) | Detailed migration phases |

---

## Project Documentation

| Project | Path | Description |
|---------|------|-------------|
| [FreeCICD](../FreeCICD/README.md) | Server | ASP.NET Core host, API controllers, SignalR hub |
| [FreeCICD.Client](../FreeCICD.Client/README.md) | Client | Blazor WebAssembly UI, state management |
| [FreeCICD.DataAccess](../FreeCICD.DataAccess/README.md) | Business Logic | Data operations, auth, integrations |
| [FreeCICD.DataObjects](../FreeCICD.DataObjects/README.md) | DTOs | Shared data transfer objects |
| [FreeCICD.EFModels](../FreeCICD.EFModels/README.md) | Persistence | Entity Framework Core entities |
| [FreeCICD.Plugins](../FreeCICD.Plugins/README.md) | Extensibility | Dynamic C# plugin system |

---

## System Architecture

```
???????????????????????????????????????????????????????????????????????????????
?                         FREECICD SYSTEM ARCHITECTURE                         ?
???????????????????????????????????????????????????????????????????????????????

                                  Internet
                                     ?
                                     ?
???????????????????????????????????????????????????????????????????????????????
?                              BROWSER                                         ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?  ?                    FreeCICD.Client (Blazor WASM)                      ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?  ?   Pages/    ?  ? BlazorData  ?  ?   Helpers   ?  ?   SignalR   ?   ?  ?
?  ?  ? Components  ?  ?   Model     ?  ? (API calls) ?  ?   Client    ?   ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                     ?                                       ?
???????????????????????????????????????????????????????????????????????????????
                                      ?
                               HTTP / WebSocket
                                      ?
???????????????????????????????????????????????????????????????????????????????
?                              SERVER ?                                       ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?  ?                     FreeCICD (ASP.NET Core)                           ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?  ? Controllers ?  ?  SignalR    ?  ?    Auth     ?  ?   Plugins   ?   ?  ?
?  ?  ?  (REST API) ?  ?    Hub      ?  ?   Handler   ?  ?   (*.cs)    ?   ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                     ?                                       ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?  ?                   FreeCICD.DataAccess (Business Logic)                ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?  ?   Auth      ?  ?   Users     ?  ?   Files     ?  ?  External   ?   ?  ?
?  ?  ?   JWT       ?  ?  Tenants    ?  ?  Settings   ?  ? Integrations?   ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                     ?                                       ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?  ?                 FreeCICD.EFModels (Entity Framework)                  ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?  ?    User     ?  ?   Tenant    ?  ? Department  ?  ?  Setting    ?   ?  ?
?  ?  ?  UserGroup  ?  ?FileStorage  ?  ?    Tag      ?  ?  Plugin     ?   ?  ?
?  ?  ???????????????  ???????????????  ???????????????  ???????????????   ?  ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                     ?                                       ?
???????????????????????????????????????????????????????????????????????????????
                                      ?
                                      ?
???????????????????????????????????????????????????????????????????????????????
?                              DATABASE                                        ?
?  ?????????????????  ?????????????????  ?????????????????  ????????????????? ?
?  ?  SQL Server   ?  ?  PostgreSQL   ?  ?    MySQL      ?  ?    SQLite     ? ?
?  ?  (Production) ?  ?  (Supported)  ?  ?  (Supported)  ?  ?  (Dev/Test)   ? ?
?  ?????????????????  ?????????????????  ?????????????????  ????????????????? ?
???????????????????????????????????????????????????????????????????????????????


???????????????????????????????????????????????????????????????????????????????
?                         SHARED LIBRARIES                                     ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  FreeCICD.DataObjects                FreeCICD.Plugins                       ?
?  ?????????????????????????          ?????????????????????????              ?
?  ?  DTOs, Enums,         ?          ?  Dynamic C# compiler  ?              ?
?  ?  Response Types,      ????????????  Plugin execution     ?              ?
?  ?  SignalR Models       ?          ?  AES encryption       ?              ?
?  ?????????????????????????          ?????????????????????????              ?
?          ?                                    ?                             ?
?          ?                                    ?                             ?
?          ??????????????????????????????????????                             ?
?                           ?                                                 ?
?               Used by all other projects                                    ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
```

---

## Data Flow Diagram

```
???????????????????????????????????????????????????????????????????????????????
?                           REQUEST/RESPONSE FLOW                              ?
???????????????????????????????????????????????????????????????????????????????

    User Action              Client                  Server              Database
         ?                     ?                       ?                    ?
         ?  Click "Save"       ?                       ?                    ?
         ? ?????????????????????                       ?                    ?
         ?                     ?                       ?                    ?
         ?                     ?  Model.Message_Saving()                    ?
         ?                     ?  (Show loading toast)                      ?
         ?                     ?                       ?                    ?
         ?                     ?  POST /api/Data/SaveUser                   ?
         ?                     ?  + Token + TenantId   ?                    ?
         ?                     ? ???????????????????????                    ?
         ?                     ?                       ?                    ?
         ?                     ?               Validate Token               ?
         ?                     ?               Check Permissions            ?
         ?                     ?                       ?                    ?
         ?                     ?                       ?  da.SaveUser()     ?
         ?                     ?                       ? ????????????????????
         ?                     ?                       ?                    ?
         ?                     ?                       ??????????????????????
         ?                     ?                       ?  User + Result     ?
         ?                     ?                       ?                    ?
         ?                     ?                       ?  SignalRUpdate     ?
         ?                     ?                       ?  (User changed)    ?
         ?                     ?                       ??????               ?
         ?                     ?                       ?    ?               ?
         ?                     ??????????????????????????????               ?
         ?                     ?  HTTP Response        ?                    ?
         ?                     ?  + SignalR Broadcast  ?                    ?
         ?                     ?                       ?                    ?
         ?                     ?  Model.Message_Saved()                     ?
         ?                     ?  Update Model.User                         ?
         ?                     ?  NotifyDataChanged()                       ?
         ?                     ?                       ?                    ?
         ???????????????????????  Re-render UI         ?                    ?
         ?  See updated data   ?                       ?                    ?
```

---

## Authentication Flow

```
???????????????????????????????????????????????????????????????????????????????
?                         AUTHENTICATION FLOW                                  ?
???????????????????????????????????????????????????????????????????????????????

    Login Page                Client                  Server              Database
         ?                     ?                       ?                    ?
         ?  Username/Password  ?                       ?                    ?
         ? ?????????????????????                       ?                    ?
         ?                     ?                       ?                    ?
         ?                     ?  POST /api/Data/Authenticate               ?
         ?                     ? ???????????????????????                    ?
         ?                     ?                       ?                    ?
         ?                     ?                       ?  Lookup User       ?
         ?                     ?                       ? ????????????????????
         ?                     ?                       ??????????????????????
         ?                     ?                       ?                    ?
         ?                     ?                       ?  Validate Password ?
         ?                     ?                       ?  Check Lockout     ?
         ?                     ?                       ?  Generate JWT      ?
         ?                     ?                       ?  Set Cookie        ?
         ?                     ?                       ?                    ?
         ?                     ?????????????????????????                    ?
         ?                     ?  User + AuthToken     ?                    ?
         ?                     ?                       ?                    ?
         ?                     ?  Store Token          ?                    ?
         ?                     ?  Model.User = user    ?                    ?
         ?                     ?  Model.LoggedIn = true                     ?
         ?                     ?  Connect SignalR      ?                    ?
         ?                     ?  JoinTenantId         ?                    ?
         ?                     ?                       ?                    ?
         ???????????????????????  Navigate to Home     ?                    ?


OAuth Flow:

    Login Page              Browser               Server            OAuth Provider
         ?                     ?                    ?                      ?
         ?  Click "Google"     ?                    ?                      ?
         ? ?????????????????????                    ?                      ?
         ?                     ?                    ?                      ?
         ?                     ?????????????????????????????????????????????
         ?                     ?  Redirect to Google                       ?
         ?                     ?                                           ?
         ?                     ?????????????????????????????????????????????
         ?                     ?  Auth code                                ?
         ?                     ?                    ?                      ?
         ?                     ??????????????????????                      ?
         ?                     ?  Code to Server    ?                      ?
         ?                     ?                    ????????????????????????
         ?                     ?                    ?  Exchange for token  ?
         ?                     ?                    ????????????????????????
         ?                     ?                    ?  User info           ?
         ?                     ?                    ?                      ?
         ?                     ?                    ?  Create/Update User  ?
         ?                     ?                    ?  Set Auth Cookie     ?
         ?                     ?                    ?                      ?
         ?                     ??????????????????????                      ?
         ?                     ?  Redirect to App   ?                      ?
```

---

## Multi-Tenancy

```
???????????????????????????????????????????????????????????????????????????????
?                           MULTI-TENANCY MODEL                                ?
???????????????????????????????????????????????????????????????????????????????

                              ???????????????????
                              ?     Tenant      ?
                              ?  (Organization) ?
                              ???????????????????
                                       ?
           ?????????????????????????????????????????????????????????
           ?                           ?                           ?
           ?                           ?                           ?
    ???????????????             ???????????????             ???????????????
    ?    Users    ?             ? Departments ?             ?  Settings   ?
    ?             ?             ?             ?             ?             ?
    ? TenantId=A  ?             ? TenantId=A  ?             ? TenantId=A  ?
    ???????????????             ???????????????             ???????????????


URL Patterns:

  Without Tenant Code:        https://app.example.com/
  With Tenant Code:          https://app.example.com/acme/


Tenant Isolation:

  ???????????????????????????????????????????????????????????????????
  ?  Every query MUST include TenantId filter:                      ?
  ?                                                                 ?
  ?  var users = await data.Users                                   ?
  ?      .Where(u => u.TenantId == currentTenantId)   ? Required!   ?
  ?      .ToListAsync();                                            ?
  ?                                                                 ?
  ?  SignalR updates are scoped to tenant groups:                   ?
  ?                                                                 ?
  ?  await Clients.Group(tenantId.ToString())                       ?
  ?      .SignalRUpdate(update);                                    ?
  ???????????????????????????????????????????????????????????????????
```

---

## Security Architecture

```
???????????????????????????????????????????????????????????????????????????????
?                         SECURITY LAYERS                                      ?
???????????????????????????????????????????????????????????????????????????????

    ???????????????????????????????????????????????????????????????????????
    ?                      1. TRANSPORT LAYER                              ?
    ?  • HTTPS (TLS 1.2+)                                                 ?
    ?  • Secure WebSocket for SignalR                                     ?
    ???????????????????????????????????????????????????????????????????????
                                    ?
                                    ?
    ???????????????????????????????????????????????????????????????????????
    ?                      2. AUTHENTICATION                               ?
    ?  • JWT Tokens (stateless)                                           ?
    ?  • Cookie Authentication (stateful)                                 ?
    ?  • OAuth 2.0 (Google, Microsoft, Facebook, Apple)                   ?
    ?  • OpenID Connect                                                   ?
    ?  • Plugin-based Custom Auth                                         ?
    ???????????????????????????????????????????????????????????????????????
                                    ?
                                    ?
    ???????????????????????????????????????????????????????????????????????
    ?                      3. AUTHORIZATION                                ?
    ?  • Role-based policies (Admin, AppAdmin, etc.)                      ?
    ?  • Tenant-scoped data access                                        ?
    ?  • Feature flags per tenant                                         ?
    ???????????????????????????????????????????????????????????????????????
                                    ?
                                    ?
    ???????????????????????????????????????????????????????????????????????
    ?                      4. DATA PROTECTION                              ?
    ?  • Password hashing (BCrypt)                                        ?
    ?  • Account lockout (5 attempts, 10 min)                             ?
    ?  • [Sensitive] attribute for DTOs                                   ?
    ?  • AES encryption for plugin code                                   ?
    ?  • Encrypted settings storage                                       ?
    ???????????????????????????????????????????????????????????????????????
```

---

## Development Workflow

### 1. Setup

```bash
# Clone repository
git clone https://github.com/WSU-EIT/FreeCICD

# Configure database
# Edit New/FreeCICD/appsettings.json

# Run application
cd New/FreeCICD
dotnet run
```

### 2. Adding Features

1. **Define DTOs** in `FreeCICD.DataObjects/DataObjects.App.cs`
2. **Add EF entities** in `FreeCICD.EFModels/EFModels/`
3. **Implement logic** in `FreeCICD.DataAccess/DataAccess.App.cs`
4. **Create endpoints** in `FreeCICD/Controllers/DataController.App.cs`
5. **Build UI** in `FreeCICD.Client/Shared/AppComponents/`

### 3. Extension Pattern

All customizations go in `*.App.*.cs` or `*.App.FreeCICD.cs` files to keep base framework intact.

---

## Additional Resources

- [.NET 10 Documentation](https://docs.microsoft.com/dotnet/)
- [Blazor Documentation](https://docs.microsoft.com/aspnet/core/blazor/)
- [Entity Framework Core](https://docs.microsoft.com/ef/core/)
- [SignalR Documentation](https://docs.microsoft.com/aspnet/core/signalr/)
